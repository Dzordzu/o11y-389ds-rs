{"__inputs":[{"name":"DS_VICTORIA-METRICS-PROMETHEUS","label":"victoria-metrics-prometheus","description":"","type":"datasource","pluginId":"prometheus","pluginName":"Prometheus"}],"__elements":{},"__requires":[{"type":"panel","id":"bargauge","name":"Bar gauge","version":""},{"type":"grafana","id":"grafana","name":"Grafana","version":"11.5.2"},{"type":"panel","id":"piechart","name":"Pie chart","version":""},{"type":"datasource","id":"prometheus","name":"Prometheus","version":"1.0.0"},{"type":"panel","id":"stat","name":"Stat","version":""},{"type":"panel","id":"state-timeline","name":"State timeline","version":""},{"type":"panel","id":"status-history","name":"Status history","version":""},{"type":"panel","id":"table","name":"Table","version":""},{"type":"panel","id":"timeseries","name":"Time series","version":""}],"annotations":{"list":[{"builtIn":1,"datasource":{"type":"grafana","uid":"-- Grafana --"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":null,"links":[],"liveNow":true,"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":35,"panels":[],"title":"General","type":"row"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Time since the last start of the exporter ","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"dark-red","value":null},{"color":"green","value":3600}]},"unit":"s"},"overrides":[]},"gridPos":{"h":6,"w":24,"x":0,"y":1},"id":25,"options":{"colorMode":"value","graphMode":"none","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"internal_runtime_seconds_active{instance=~\"$instance\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Exporter runtime","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"stat"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Version of the 389ds instance","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"auto"},"inspect":false},"mappings":[{"options":{"pattern":"^([a-zA-Z0-9_-]+).*:[0-9]+.*","result":{"index":0,"text":"$1"}},"type":"regex"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":7,"w":7,"x":0,"y":7},"id":24,"options":{"cellHeight":"sm","footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"showHeader":true,"sortBy":[]},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","exemplar":false,"expr":"group by(instance, version) (monitor_version{instance=~\"$instance\"})","format":"table","fullMetaSearch":false,"includeNullMetadata":true,"instant":true,"legendFormat":"__auto","range":false,"refId":"A","useBackend":false}],"title":"389ds version","transformations":[{"id":"filterFieldsByName","options":{"include":{"names":["instance","version"]}}}],"transparent":true,"type":"table"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Healthcheck command executed on host ","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"fillOpacity":70,"hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineWidth":0,"spanNulls":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"green","value":1}]}},"overrides":[]},"gridPos":{"h":7,"w":6,"x":7,"y":7},"id":21,"options":{"alignValue":"left","legend":{"displayMode":"list","placement":"bottom","showLegend":true},"mergeValues":false,"rowHeight":0.9,"showValue":"auto","tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"dsctl_healthcheck_healthy{instance=~\"$instance\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Healthcheck","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"state-timeline"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"https://www.port389.org/docs/389ds/design/healthcheck-design.html","fieldConfig":{"defaults":{"color":{"fixedColor":"text","mode":"fixed"},"custom":{"align":"auto","cellOptions":{"type":"color-text"},"filterable":true,"inspect":false},"mappings":[{"options":{"HIGH":{"color":"dark-red","index":2},"LOW":{"color":"dark-yellow","index":0},"MEDIUM":{"color":"dark-orange","index":1}},"type":"value"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":7,"w":6,"x":13,"y":7},"id":22,"options":{"cellHeight":"sm","footer":{"countRows":false,"enablePagination":true,"fields":"","reducer":["sum"],"show":false},"frameIndex":0,"showHeader":true,"sortBy":[{"desc":true,"displayName":"severity"}]},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","exemplar":false,"expr":"sum by(dsle, instance, severity) (dsctl_healthcheck_error{instance=~\"$instance\"}) > 0","format":"table","fullMetaSearch":false,"includeNullMetadata":true,"instant":true,"legendFormat":"__auto","range":false,"refId":"A","useBackend":false}],"title":"Healthcheck errors","transformations":[{"id":"renameByRegex","options":{"regex":".*dsle=\"([A-Z0-9]+)\".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1 ($2)"}},{"id":"filterByValue","options":{"filters":[{"config":{"id":"equal","options":{"value":"0"}},"fieldName":"dsle"}],"match":"any","type":"exclude"}},{"id":"filterFieldsByName","options":{"include":{"names":["dsle","instance","severity"]}}},{"id":"rowsToFields","options":{"mappings":[{"fieldName":"severity","handlerKey":"mappings.value"}]}}],"transparent":true,"type":"table"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Users affected by unresolvable gids","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[],"noValue":"0"},"overrides":[]},"gridPos":{"h":7,"w":5,"x":19,"y":7},"id":23,"options":{"displayLabels":["value"],"legend":{"displayMode":"list","placement":"bottom","showLegend":true},"pieType":"donut","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"avg by(gid) (query_gids_unresolvable_count{instance=~\"$instance\"})","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Unresolvable primary GIDs","transformations":[{"id":"renameByRegex","options":{"regex":".*gid=\"([0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"piechart"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":14},"id":34,"panels":[{"datasource":{"type":"prometheus","uid":"${Datasource}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":-1,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":2,"gradientMode":"hue","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineStyle":{"fill":"solid"},"lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"decbytes"},"overrides":[]},"gridPos":{"h":10,"w":9,"x":0,"y":15},"id":31,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"monitor_disk_available{instance=~\"$instance\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Disk available","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*partition=\"([a-zA-Z0-9\\/\\\\\\._-]+)\".*","renamePattern":"$2 ($1)"}}],"transparent":true,"type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[],"unit":"decbytes"},"overrides":[]},"gridPos":{"h":10,"w":6,"x":9,"y":15},"id":33,"options":{"legend":{"displayMode":"list","placement":"bottom","showLegend":true},"pieType":"pie","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"sum by(instance) (monitor_disk_used{instance=~\"$instance\", partition=\"/var/lib/dirsrv\"})","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Disk used (dirsrv, by host)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*partition=\"([a-zA-Z0-9\\/\\\\\\._-]+)\".*","renamePattern":"$2 ($1)"}}],"transparent":true,"type":"piechart"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":-1,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":2,"gradientMode":"hue","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineStyle":{"fill":"solid"},"lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":10,"w":9,"x":15,"y":15},"id":32,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"monitor_disk_use_percentage{instance=~\"$instance\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Disk (use %)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*partition=\"([a-zA-Z0-9\\/\\\\\\._-]+)\".*","renamePattern":"$2 ($1)"}}],"transparent":true,"type":"timeseries"}],"title":"Disk","type":"row"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":15},"id":36,"panels":[{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"List of active replication agreements by host","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"auto"},"inspect":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":11,"x":0,"y":26},"id":37,"options":{"cellHeight":"sm","footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"showHeader":true},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","exemplar":false,"expr":"group by(host, agreement, instance) (replication_agreement{instance=~\"$instance\"}) > 0","format":"table","fullMetaSearch":false,"includeNullMetadata":true,"instant":true,"legendFormat":"__auto","range":false,"refId":"A","useBackend":false}],"title":"Agreements","transformations":[{"id":"labelsToFields","options":{}},{"id":"filterFieldsByName","options":{"include":{"names":["host","instance"]}}},{"id":"organize","options":{"excludeByName":{},"includeByName":{},"indexByName":{"Time":0,"host":2,"instance":1},"renameByName":{"Time":"","host":"To","instance":"From"}}}],"transparent":true,"type":"table"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Number of the active replication agreements by host (master)","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[]},"overrides":[]},"gridPos":{"h":8,"w":6,"x":11,"y":26},"id":38,"options":{"legend":{"displayMode":"list","placement":"bottom","showLegend":false},"pieType":"donut","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"sum by(instance) (replication_agreement{instance=~\"$instance\"})","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Active agreements by host","transformations":[{"id":"renameByRegex","options":{"regex":"([a-zA-Z0-9_-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"piechart"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Maximum error returned for the LDAP agreement query. Should always be 0","fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"custom":{"fillOpacity":70,"hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineWidth":0,"spanNulls":true},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":1}]}},"overrides":[]},"gridPos":{"h":9,"w":7,"x":17,"y":26},"id":39,"options":{"alignValue":"right","legend":{"displayMode":"list","placement":"bottom","showLegend":true},"mergeValues":true,"rowHeight":0.9,"showValue":"auto","tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"max by(instance) (replication_agreement_ldap_status{instance=~\"$instance\"})","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Max retrun code for agreement (by host)","transformations":[{"id":"renameByRegex","options":{"regex":"([a-zA-Z0-9_-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"state-timeline"}],"title":"Replication","type":"row"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":16},"id":15,"panels":[{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Average number of posix group within repo","fieldConfig":{"defaults":{"color":{"fixedColor":"yellow","mode":"fixed"},"custom":{"axisBorderShow":true,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":29,"gradientMode":"hue","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineStyle":{"dash":[1,10],"fill":"dot"},"lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":36},"id":19,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"avg(custom_query_object_count{instance=~\"$instance\", query=\"list-posix-groups\"})","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Posix groups count","transformations":[{"id":"renameByRegex","options":{"regex":".*","renamePattern":"Detected objects"}}],"transparent":true,"type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Average number of posix users within repo","fieldConfig":{"defaults":{"color":{"fixedColor":"blue","mode":"fixed"},"custom":{"axisBorderShow":true,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":29,"gradientMode":"hue","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineStyle":{"dash":[1,10],"fill":"dot"},"lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"blue"}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":36},"id":20,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"avg(custom_query_object_count{instance=~\"$instance\", query=\"list-posix-users\"})","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Posix users count","transformations":[{"id":"renameByRegex","options":{"regex":".*","renamePattern":"Detected objects"}}],"transparent":true,"type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Difference between host LDAP groups number and the number reported by the other instances (on average)","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"yellow"},{"color":"dark-red","value":1}]}},"overrides":[]},"gridPos":{"h":5,"w":12,"x":0,"y":44},"id":17,"options":{"colorMode":"value","graphMode":"none","justifyMode":"center","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"code","expr":"abs(custom_query_object_count{instance=~\"$instance\", query=\"list-posix-groups\"} - avg(custom_query_object_count{instance=~\"389ds.*\", query=\"list-posix-groups\"}))","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Difference from average object count (groups)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"stat"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Difference between host LDAP users number and the number reported by the other instances (on average)","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"blue"},{"color":"purple","value":1}]}},"overrides":[]},"gridPos":{"h":5,"w":12,"x":12,"y":44},"id":18,"options":{"colorMode":"value","graphMode":"none","justifyMode":"center","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"code","expr":"abs(custom_query_object_count{instance=~\"$instance\", query=\"list-posix-users\"} - avg(custom_query_object_count{instance=~\"389ds.*\", query=\"list-posix-users\"}))","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Difference from average object count (users)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"stat"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"fillOpacity":16,"hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineWidth":1},"fieldMinMax":false,"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"yellow"},{"color":"orange","value":1000},{"color":"dark-orange","value":1200}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":7,"w":12,"x":0,"y":49},"id":4,"options":{"colWidth":0.9,"legend":{"displayMode":"list","placement":"bottom","showLegend":true},"rowHeight":0.73,"showValue":"always","tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","exemplar":false,"expr":"custom_query_duration_ms{instance=~\"$instance\", query=\"list-posix-groups\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"LDAPs response time (groups)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"status-history"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"fillOpacity":16,"hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineWidth":2},"fieldMinMax":false,"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"blue"},{"color":"purple","value":1800},{"color":"dark-purple","value":2000}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":7,"w":12,"x":12,"y":49},"id":16,"options":{"colWidth":0.9,"legend":{"displayMode":"list","placement":"bottom","showLegend":true},"rowHeight":0.73,"showValue":"always","tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","exemplar":false,"expr":"custom_query_duration_ms{instance=~\"$instance\", query=\"list-posix-users\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"LDAPs response time (users)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"status-history"}],"title":"Query timings","type":"row"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":17},"id":9,"panels":[],"title":"Connections live","type":"row"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Avg connections by ip per scrape (since exporter startup)\n","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[]},"overrides":[]},"gridPos":{"h":8,"w":5,"x":0,"y":18},"id":27,"options":{"displayLabels":["percent"],"legend":{"displayMode":"table","placement":"bottom","showLegend":true,"values":["percent","value"]},"pieType":"pie","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"sum by(ip) (monitor_connection_avg_by_ip{instance=~\"$instance\"})","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Connections by IP","transformations":[{"id":"filterFieldsByName","options":{"include":{"names":["Time","10.26.25.121","10.26.25.155","10.26.25.170","10.26.25.171","local"]}}}],"transparent":true,"type":"piechart"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Active connections gathered by counting records on the cn=monitor","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":10,"gradientMode":"opacity","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineStyle":{"fill":"solid"},"lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":7,"x":5,"y":18},"id":7,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"monitor_connection_count{instance=~\"$instance\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Active connections (counted)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Avg connections by dn per scrape (since exporter startup)","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"fieldMinMax":false,"mappings":[]},"overrides":[{"__systemRef":"hideSeriesFrom","matcher":{"id":"byNames","options":{"mode":"exclude","names":["cn=admin","cn=bareos,ou=service-accounts,dc=e-science.pl","cn=bem-ln,ou=service-accounts,dc=e-science.pl","cn=bem-ln-dev,ou=service-accounts,dc=e-science.pl","cn=bem-sn,ou=service-accounts,dc=e-science.pl","cn=bem-wn,ou=service-accounts,dc=e-science.pl","cn=cluster-postfix,ou=service-accounts,dc=e-science.pl","cn=nc,ou=groups,ou=spinlab,dc=e-science.pl","cn=postfix,ou=service-accounts,dc=e-science.pl","cn=replication manager,cn=config","cn=ro-clarin,ou=service-accounts,dc=e-science.pl","cn=ro-granty,dc=e-science.pl","cn=ro-hpc,dc=e-science.pl","cn=ro-iati,ou=service-accounts,dc=e-science.pl","cn=ro-k41,ou=service-accounts,dc=e-science.pl","cn=ro-med,ou=service-accounts,dc=e-science.pl","cn=ro-minio,dc=e-science.pl","cn=ro-nc-general,dc=e-science.pl","cn=ro-nopasswd,dc=e-science.pl","cn=ro-passwd-slurm,dc=e-science.pl","cn=ro-salseth,ou=service-accounts,dc=e-science.pl","cn=ro-sus1-hpc,ou=service-accounts,dc=e-science.pl","cn=ro-sus1-s3min,ou=service-accounts,dc=e-science.pl","cn=ro-sympa,dc=e-science.pl","cn=ro-zammad,dc=e-science.pl","cn=rstudio-server,ou=service-accounts,dc=e-science.pl","cn=sshdysk,ou=service-accounts,dc=e-science.pl","cn=vsys,ou=service-accounts,dc=e-science.pl","uid=pawglu3029,ou=people,dc=e-science.pl","uid=cmt,ou=people,dc=e-science.pl","NULLDN","cn=paloalto,ou=service-accounts,dc=e-science.pl"],"prefix":"All except:","readOnly":true}},"properties":[{"id":"custom.hideFrom","value":{"legend":false,"tooltip":false,"viz":true}}]}]},"gridPos":{"h":16,"w":12,"x":12,"y":18},"id":26,"options":{"displayLabels":["percent"],"legend":{"displayMode":"table","placement":"bottom","showLegend":true,"sortBy":"Value","sortDesc":true,"values":["percent","value"]},"pieType":"pie","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"sum by(dn) (monitor_connection_avg_by_dn{instance=~\"$instance\"})","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Connections by DN","transformations":[{"id":"renameByRegex","options":{"regex":"","renamePattern":"$1"}}],"transparent":true,"type":"piechart"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Active connections gathered by counting records on the cn=monitor\n","fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"decimals":0,"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":6,"x":0,"y":26},"id":5,"options":{"displayMode":"lcd","legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"maxVizHeight":300,"minVizHeight":10,"minVizWidth":0,"namePlacement":"top","orientation":"horizontal","reduceOptions":{"calcs":["mean"],"fields":"","values":false},"showUnfilled":true,"sizing":"auto","valueMode":"color"},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"avg_over_time(monitor_connection_count{instance=~\"$instance\"}[1h])","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"LDAP Average connections (last 1h)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"bargauge"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Active connections gathered by counting records on the cn=monitor\n","fieldConfig":{"defaults":{"color":{"mode":"continuous-GrYlRd"},"decimals":0,"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":6,"x":6,"y":26},"id":6,"options":{"displayMode":"lcd","legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"maxVizHeight":300,"minVizHeight":10,"minVizWidth":0,"namePlacement":"auto","orientation":"horizontal","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showUnfilled":true,"sizing":"auto","valueMode":"color"},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"avg_over_time(monitor_connection_count{instance=~\"$instance\"}[$__interval])","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"LDAP Average connections (interval)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"bargauge"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":4,"gradientMode":"opacity","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineStyle":{"fill":"solid"},"lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"sci"},"overrides":[]},"gridPos":{"h":8,"w":10,"x":0,"y":34},"id":29,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"monitor_totalconnections{instance=~\"$instance\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Total connections since last restart","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Displays how many times a connection [hit max thread](https://docs.redhat.com/en/documentation/red_hat_directory_server/11/html/performance_tuning_guide/tracking-performance#monitoring-directory-server-using-the-command-line)","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":50},{"color":"red","value":100}]}},"overrides":[]},"gridPos":{"h":8,"w":8,"x":10,"y":34},"id":30,"options":{"displayMode":"gradient","legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":false},"maxVizHeight":300,"minVizHeight":16,"minVizWidth":8,"namePlacement":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showUnfilled":true,"sizing":"auto","valueMode":"color"},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"monitor_maxthreadsperconnhits{instance=~\"$instance\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Hit max thread","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"bargauge"},{"datasource":{"type":"prometheus","uid":"${Datasource}"},"description":"Active connections returned by the SNMP entry in cn=monitor","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":12,"gradientMode":"opacity","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":6,"x":18,"y":34},"id":28,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"single","sort":"none"}},"pluginVersion":"11.5.2","targets":[{"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"disableTextWrap":false,"editorMode":"builder","expr":"monitor_snmp_connections{instance=~\"$instance\"}","fullMetaSearch":false,"includeNullMetadata":true,"legendFormat":"__auto","range":true,"refId":"A","useBackend":false}],"title":"Active connections (SNMP)","transformations":[{"id":"renameByRegex","options":{"regex":".*instance=\"([a-zA-Z0-9-]+).*","renamePattern":"$1"}}],"transparent":true,"type":"timeseries"}],"refresh":"1m","schemaVersion":40,"tags":["ldap","389ds","bem2","auth"],"templating":{"list":[{"current":{},"datasource":{"type":"prometheus","uid":"${DS_VICTORIA-METRICS-PROMETHEUS}"},"definition":"label_values({instance=~\"389ds.*\"},instance)","includeAll":true,"multi":true,"name":"instance","options":[],"query":{"qryType":1,"query":"label_values({instance=~\"389ds.*\"},instance)","refId":"PrometheusVariableQueryEditor-VariableQuery"},"refresh":1,"regex":"","sort":1,"type":"query"},{"current":{},"name":"Datasource","options":[],"query":"prometheus","refresh":1,"regex":"","type":"datasource"}]},"time":{"from":"now-1h","to":"now"},"timepicker":{},"timezone":"","title":"389ds Exporter","uid":"febfsiyhb9b7kb","version":46,"weekStart":""}
